.. _micropvr_control:

*******************************************
5. Вспомогательная утилита micropvr_control
*******************************************

micropvr_control - стандартная утилита для управления и мониторинга в составе пакета micropvr. Требует включенного JSON RPC API.

Пример использования (получение списка файлов записей для канала с ID 4): ::

    micropvr_control -H 127.0.0.1 -f get_records -a 4 -d

5.1. Аргументы запуска micropvr_control
=======================================

\-h
  Вывести краткую справку.
\-V
  Вывести версию.
\-H
  Хост API micropvr. Если опция не задана, то будет использоваться 127.0.0.1.
\-p
  Порт API micropvr. Если опция не задана, то будет использоваться 4089.
\-q
  "Тихий режим". Не выводить сообщения в стандартный поток.
\-d
  "Режим отладки". Печатать ответ от сервера в стандартный поток в виде JSON-документов.
\-y
  Не запрашивать подтверждение для операций удаления и отмены.
\-f
  Имя функции API. Список функций приведён ниже.
\-a
  Неименовынные аргументы функции. Задаются в строго определённом порядке через пробел.
\-A
  Именованные аргументы функции. Задаются в любом порядке через пробел в формате имя_аргумента=аргумент. 
  Например, -A channel_ID=8 record_location=/tmp/pvr. Имена аргументов чувствительны к регистру.
  
Должно быть указано не более одной опции -a или -A. В противном случае корректное поведение не гарантируется.

5.2. Функции micropvr_control
=============================

``get_records [channel_id]``
  Выводит список файлов записей для канала ``channel_id``. Если ``channel_id`` не указан, выводит все файлы записей.

``cancel_task channel_id [record_location]``
  Отменяет все выполняемые задачи для канала с ID ``channel_id`` и директории записи ``record_location``. 
  Если ``record_location`` не задан, отменяет все задачи для заданного канала.

``delete_records [timestamp] [channel_id]``
  Удаляет файлы, в которые не ведётся активная запись, для канала ``channel_id`` и запись которых была начата не позже ``timestamp``.
  Если ``channel_id`` и ``timestamp`` не указаны, удаляет все записи.

``delete_records_days ndays [channel_id]``
  Удаляет файлы, в которые не ведётся активная запись, для канала ``channel_id`` за самые старые ``ndays`` дней.
  Если ``channel_id`` не указан, удаляет все записи за самые старые ``ndays`` дней.
    
